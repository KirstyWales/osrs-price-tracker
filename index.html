<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OSRS Multi-Herb Farming Profit Calculator</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 20px auto;
    padding: 20px;
  }
  label {
    display: block;
    margin: 10px 0 5px;
  }
  input[type="number"], select {
    width: 100%;
    padding: 8px;
    font-size: 1rem;
    border-radius: 4px;
    border: none;
  }
  input[type="checkbox"] {
    margin-right: 8px;
    transform: scale(1.1);
  }
  .checkbox-label {
    margin-top: 6px;
    user-select: none;
  }
  button {
    margin-top: 20px;
    background-color: #4caf50;
    border: none;
    color: white;
    padding: 12px;
    width: 100%;
    font-size: 1.1rem;
    border-radius: 6px;
    cursor: pointer;
  }
  #results {
    margin-top: 25px;
    background: #222;
    padding: 15px;
    border-radius: 6px;
    font-size: 0.9rem;
    line-height: 1.4;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    padding: 10px 8px;
    border-bottom: 1px solid #444;
    text-align: center;
  }
  th {
    background-color: #333;
  }
</style>
</head>
<body>

<h1>OSRS Multi-Herb Farming Profit Calculator</h1>

<form id="calcForm">
  <label for="patches">Number of farming patches (1â€“12):</label>
  <input type="number" id="patches" name="patches" value="8" min="1" max="12" required />

  <label for="herbSelect">Select Herb:</label>
  <select id="herbSelect">
    <option value="Ranarr">Ranarr</option>
    <option value="Toadflax">Toadflax</option>
    <option value="Snapdragon">Snapdragon</option>
  </select>

  <label class="checkbox-label">
    <input type="checkbox" id="magicSecateurs" /> Magic Secateurs (+10% yield)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="farmingCape" /> Farming Cape (+5% yield)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="faladorDiary" /> Falador Medium Diary (+10% yield on Falador patch)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="catherbyDiaryMed" /> Kandarin Medium Diary (+5% yield)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="catherbyDiaryHard" /> Kandarin Hard Diary (+10% yield)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="catherbyDiaryElite" /> Kandarin Elite Diary (+15% yield)
  </label>
  <label class="checkbox-label">
    <input type="checkbox" id="kourendDiary" /> Hard Kourend & Kebos Diary (+5% yield)
  </label>

  <button type="submit">Calculate Profit</button>
</form>

<div id="results"></div>

<script>
  const API_URL = 'https://prices.runescape.wiki/api/v1/osrs/latest';
  const form = document.getElementById('calcForm');
  const resultsDiv = document.getElementById('results');

  const HERBS = {
    Ranarr: {
      name: 'Ranarr',
      seedID: 5295,
      herbID: 257,
      secondaryID: 231,
      potionID: 2434,
      baseYield: 4.4
    },
    Toadflax: {
      name: 'Toadflax',
      seedID: 5297,
      herbID: 2998,
      secondaryID: 6693,
      potionID: 6685,
      baseYield: 4.3
    },
    Snapdragon: {
      name: 'Snapdragon',
      seedID: 5301,
      herbID: 3000,
      secondaryID: 223,
      potionID: 3026,
      baseYield: 3.8
    }
  };

  const ULTRACOMPOST_ID = 21483;
  const VIAL_ID = 227;
  let livePrices = {};

  async function fetchLivePrices() {
    try {
      const res = await fetch(API_URL);
      const data = await res.json();
      livePrices = data.data || {};
    } catch (e) {
      alert('Failed to fetch live prices. Try refreshing.');
    }
  }

  function getPrice(id) {
    return livePrices[id]?.high || 0;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    await fetchLivePrices();

    const herbKey = document.getElementById('herbSelect').value;
    const herb = HERBS[herbKey];
    const patches = Number(form.patches.value);

    let yieldBonus = 0;
    if (form.magicSecateurs.checked) yieldBonus += 0.10;
    if (form.farmingCape.checked) yieldBonus += 0.05;
    if (form.faladorDiary.checked) yieldBonus += 0.10;
    if (form.catherbyDiaryMed.checked) yieldBonus += 0.05;
